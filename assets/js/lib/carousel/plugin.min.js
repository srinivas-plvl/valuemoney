/**
 * Custom Responsive Carousel
 * https://github.com/jdeathe/Dynamic-carousel
 * Based on original code by:
 * ! (c) Mat Marquis (@wilto). MIT License. http://wil.to/3a
 */
(function(c,l){var m=0;c.fn.getPercentage=function(){return this.attr("style").match(/margin\-left:(.*[0-9])/i)&&parseInt(RegExp.$1)};c.fn.adjRounding=function(j){var a=c(this),j=a.find(j),a=a.parent().width()-j.eq(0).width();if(0!==a){c(j).css("position","relative");for(var g=0;g<j.length;g++)j.eq(g).css("left",a*g+"px")}return this};c.fn.transitionSupport=function(){dBody=document.body||document.documentElement;dBody.setAttribute("style","transition:top 1s ease;-webkit-transition:top 1s ease;-moz-transition:top 1s ease;"); return!(!dBody.style.transition&&!dBody.style.webkitTransition&&!dBody.style.msTransition&&!dBody.style.OTransition&&!dBody.style.MozTransition)};c.fn.rcarousel=function(j){if(!this.data("rcarousel-initialized")){this.data("rcarousel-initialized",!0);var a=c.extend({slider:".slider",slide:".slide",prevSlide:null,nextSlide:null,slideHed:null,addPagination:!1,addNav:j!=l&&(j.prevSlide||j.nextSlide)?!1:!0,namespace:"rcarousel",speed:300,rotate:!1,startSlide:1,lazy:!1,lazyFadeDuration:300,autoRotate:!1, autoHeight:!1},j),g=this,i=!1,f={init:function(){m++;g.each(function(e){var b=c(this),d=b.find(a.slider),h=b.find(a.slide),k=h.length,g="all "+a.speed/1E3+"s ease",i="rcarousel-"+m+"-"+e,j=1>a.startSlide?1:a.startSlide>k?k:parseInt(a.startSlide);1>=h.length||(b.css({overflow:"hidden",width:"100%"}).attr("role","application"),d.attr("id",d[0].id||"rcarousel-"+m+"-"+e).css({marginLeft:-(100*(j-1))+"%","float":"left",width:100*k+"%","-webkit-transition":g,"-moz-transition":g,"-ms-transition":g,"-o-transition":g, transition:g}).bind("rcarouselmove",f.move).bind("nextprev",f.nextPrev).bind("navstate",f.navState).bind("loadimages",f.loadImages),h.css({"float":"left",width:100/k+"%"}).each(function(b){var e=c(this);e.attr({role:"tabpanel document",id:i+"-slide"+b});a.addPagination&&e.attr("aria-labelledby",i+"-tab"+b)}),a.addPagination&&f.addPagination(),a.addNav&&f.addNav(),d.trigger("navstate",{current:-(100*(j-1))}),!1==a.lazy&&d.trigger("loadimages"))})},loadImages:function(){!0!=i&&($images=c(this).find(a.slide+ " img"),$images.each(function(e){c(this).removeClass("lazy");title=c(this).attr("title");e!=a.startSlide-1&&"undefined"!==typeof title&&(c(this).hide(),img=title.replace("Image: ",""),c(this).removeAttr("title").attr("src",img).fadeIn(a.lazyFadeDuration))}),i=!0)},addNav:function(){g.each(function(){var e=c(this),b=e.find(a.slider),d=e.find(a.slide).length,d=1>a.startSlide?1:a.startSlide>d?d:parseInt(a.startSlide),b=b[d-1].id,b=['<ul class="slidecontrols" role="navigation">','\t<li role="presentation"><a href="#'+ b+'" class="'+a.namespace+'-next">Next</a></li>','\t<li role="presentation"><a href="#'+b+'" class="'+a.namespace+'-prev">Prev</a></li>',"</ul>"].join("");a=c.extend(a,{nextSlide:"."+a.namespace+"-next",prevSlide:"."+a.namespace+"-prev"});e.prepend(b)})},addPagination:function(){g.each(function(e){for(var b=c(this),d=c('<ul class="'+a.namespace+'-tabs" role="tablist navigation" />'),h=b.find(a.slide),k=h.length,e="rcarousel-"+m+"-"+e;k--;){var f=h.eq(k).find(a.slideHed).text()||"Page "+(k+1),f=['<li role="presentation">', '<a href="#'+e+"-slide"+k+'"',' aria-controls="'+e+"-slide"+k+'"',' id="'+e+"-tab"+k+'" role="tab">'+f+"</a>","</li>"].join("");d.prepend(f)}b.prepend('<div class="pagination" style="display:inline-block;margin:0" />');d.appendTo(".pagination").find("li").keydown(function(a){var b=c(this),e=b.prev().find("a"),b=b.next().find("a");switch(a.which){case 37:case 38:e.length&&e.trigger("click").focus();a.preventDefault();break;case 39:case 40:b.length&&b.trigger("click").focus(),a.preventDefault()}}).find("a").click(function(e){var d= c(this);"false"==d.attr("aria-selected")&&(d=-(100*d.parent().index()),b.find(a.slider).trigger("rcarouselmove",{moveTo:d}));e.preventDefault()})})},roundDown:function(a){a=parseInt(a,10);return 100*Math.ceil((a-a%100)/100)},navState:function(e,b){var d=c(this),h=d.find(a.slide),f=-(b.current/100),g=h.eq(f);d.attr("aria-activedescendant",g[0].id);g.addClass(a.namespace+"-active-slide").attr("aria-hidden",!1).siblings().removeClass(a.namespace+"-active-slide").attr("aria-hidden",!0);if(a.prevSlide|| a.nextSlide)d=c('[href*="#'+this.id+'"]'),d.removeClass(a.namespace+"-disabled"),0==f?d.filter(a.prevSlide).addClass(a.namespace+"-disabled"):f==h.length-1&&d.filter(a.nextSlide).addClass(a.namespace+"-disabled");a.addPagination&&(h=g.attr("aria-labelledby"),h=c("#"+h),h.parent().addClass(a.namespace+"-active-tab active").siblings().removeClass(a.namespace+"-active-tab active").find("a").attr({"aria-selected":!1,tabindex:-1}),h.attr({"aria-selected":!0,tabindex:0}))},move:function(e,b){var d=c(this); d.trigger(a.namespace+"-beforemove").trigger("navstate",{current:b.moveTo}).trigger("loadimages");if(d.transitionSupport())d.adjRounding(a.slide).css("marginLeft",b.moveTo+"%").one("transitionend webkitTransitionEnd OTransitionEnd",function(){c(this).trigger(a.namespace+"-aftermove")});else d.adjRounding(a.slide).animate({marginLeft:b.moveTo+"%"},{duration:a.speed,queue:!1},function(){c(this).trigger(a.namespace+"-aftermove")})},nextPrev:function(e,b){var d=c(this),h=d?d.getPercentage():0,g=d.find(a.slide), i="prev"===b.dir?0!=h:-h<100*(g.length-1),g=100*-(g.length-1);$target=c('[href="#'+this.id+'"]');if(!d.is(":animated")&&i)switch(h="prev"===b.dir?0!=h%100?f.roundDown(h):h+100:0!=h%100?f.roundDown(h)-100:h-100,d.trigger("rcarouselmove",{moveTo:h}),$target.removeClass(a.namespace+"-disabled").removeAttr("aria-disabled"),h){case g:$target.filter(a.nextSlide).addClass(a.namespace+"-disabled").attr("aria-disabled",!0);break;case 0:$target.filter(a.prevSlide).addClass(a.namespace+"-disabled").attr("aria-disabled", !0)}else h=a.rotate&&"next"===b.dir?0:a.rotate&&"prev"===b.dir?g:f.roundDown(h),d.trigger("rcarouselmove",{moveTo:h})}};f.init(this);c(a.nextSlide+","+a.prevSlide).bind("click",function(e){var b=c(this),d=this.hash,h=b.is(a.prevSlide)?"prev":"next",d=c(d);if(b.is("."+a.namespace+"-disabled"))return!1;d.trigger("nextprev",{dir:h});e.preventDefault()}).bind("keydown",function(a){var b=this.hash;switch(a.which){case 37:case 38:c("#"+b).trigger("nextprev",{dir:"next"});a.preventDefault();break;case 39:case 40:c("#"+ b).trigger("nextprev",{dir:"prev"}),a.preventDefault()}});g.bind("dragSnap",{wrap:this,slider:a.slider},function(e,b){c(this).find(a.slider).trigger("nextprev",{dir:"left"===b.direction?"next":"prev"})});g.each(function(){var e,b=c(this),d=parseInt(a.autoRotate,10)>parseInt(a.speed)?parseInt(a.autoRotate,10):5E3,h=b.find(a.slide).length,f=b.find(a.slider),g=function(){clearInterval(e);e=setInterval(function(){i();f.trigger("nextprev",{dir:"next"})},d)},i=function(){if(a.rotate)g();else switch(-(c(a.slider).getPercentage()/ 100)+1){case h:clearInterval(e);e=setInterval(function(){i();f.trigger("nextprev",{dir:"prev"})},d);break;default:g()}};!1!=a.autoRotate&&(e=setInterval(i,d),b.attr("aria-live","polite").bind("mouseenter click touchstart",function(){clearInterval(e)}),b.attr("aria-live","polite").bind("mouseleave",function(){e=setInterval(i,d)}))});return this}}})(jQuery); $.event.special.dragSnap={setup:function(c){var l=$(this),m=function(a,c){var i=c?"all 0.3s ease":"none";a.css({"-webkit-transition":i,"-moz-transition":i,"-ms-transition":i,"-o-transition":i,transition:i})},j=function(a){a=parseInt(a,10);return 100*Math.ceil((a-a%100)/100)};l.bind("snapback",function(a,c){var i=c.target,f=void 0!=i.attr("style")?i.getPercentage():0,f=!1===c.left?j(f)-100:j(f);m(i,!0);i.transitionSupport()?i.css("marginLeft",f+"%"):i.animate({marginLeft:f+"%"},opt.speed)}).bind("touchstart", function(a){function g(a){var c=a.originalEvent.touches?a.originalEvent.touches[0]:a;e={time:(new Date).getTime(),coords:[c.pageX,c.pageY]};deltaX=Math.abs(f.coords[0]-c.pageX);deltaY=Math.abs(f.coords[1]-c.pageY);left=d+100*((e.coords[0]-f.coords[0])/f.origin.width());if(f&&!(15>deltaX||0>=d&&0<left))b.trigger("loadimages"),15<=deltaX&&(f.interacting=!0,b.css({"margin-left":left+"%"}),a.preventDefault())}var i=a.originalEvent.touches?a.originalEvent.touches[0]:a,f={time:(new Date).getTime(),coords:[i.pageX, i.pageY],origin:$(a.target).closest(c.wrap),interacting:!1},e,b=$(a.target).closest(c.slider),d=void 0!=b.attr("style")?b.getPercentage():0;m(b,!1);l.bind("gesturestart",function(){l.unbind("touchmove",g).unbind("touchend",g)}).bind("touchmove",g).one("touchend",function(a){l.unbind("touchmove",g);m(b,!0);if(f&&e){var c=Math.abs(f.coords[0]-e.coords[0]),d=Math.abs(f.coords[1]-e.coords[1]),i=f.coords[0]>e.coords[0];if(20<c&&c>d)a.preventDefault();else{f.interacting&&l.trigger("snapback",{target:b, left:i});return}a=f.origin.width()/4;-c>a||c>a?f.origin.trigger("dragSnap",{direction:i?"left":"right"}):l.trigger("snapback",{target:b,left:i})}f=e=void 0})})}};