/* =========================================================
 * bootstrap-datepicker.js
 * http://www.eyecon.ro/bootstrap-datepicker
 * =========================================================
 * Copyright 2012 Stefan Petre
 * Improvements by Andrew Rowls
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */

!function(d){function q(){return new Date(Date.UTC.apply(Date,arguments))}var m=function(a,b){var c=this;this.element=d(a);this.language=b.language||this.element.data("date-language")||"en";this.language=this.language in n?this.language:"en";this.format=k.parseFormat(b.format||this.element.data("date-format")||"mm/dd/yyyy");this.picker=d(k.template).appendTo("body").on({click:d.proxy(this.click,this)});this.isInput=this.element.is("input");this.hasInput=(this.component=this.element.is(".date")?this.element.find(".add-on"): !1)&&this.element.find("input").length;this.component&&0===this.component.length&&(this.component=!1);this._attachEvents();this.forceParse=!0;"forceParse"in b?this.forceParse=b.forceParse:"dateForceParse"in this.element.data()&&(this.forceParse=this.element.data("date-force-parse"));d(document).on("mousedown",function(a){0==d(a.target).closest(".datepicker").length&&c.hide()});this.autoclose=!1;"autoclose"in b?this.autoclose=b.autoclose:"dateAutoclose"in this.element.data()&&(this.autoclose=this.element.data("date-autoclose")); this.keyboardNavigation=!0;"keyboardNavigation"in b?this.keyboardNavigation=b.keyboardNavigation:"dateKeyboardNavigation"in this.element.data()&&(this.keyboardNavigation=this.element.data("date-keyboard-navigation"));switch(b.startView||this.element.data("date-start-view")){case 2:case "decade":this.viewMode=this.startViewMode=2;break;case 1:case "year":this.viewMode=this.startViewMode=1;break;default:this.viewMode=this.startViewMode=0}this.todayBtn=b.todayBtn||this.element.data("date-today-btn")|| !1;this.todayHighlight=b.todayHighlight||this.element.data("date-today-highlight")||!1;this.weekStart=(b.weekStart||this.element.data("date-weekstart")||n[this.language].weekStart||0)%7;this.weekEnd=(this.weekStart+6)%7;this.startDate=-Infinity;this.endDate=Infinity;this.daysOfWeekDisabled=[];this.setStartDate(b.startDate||this.element.data("date-startdate"));this.setEndDate(b.endDate||this.element.data("date-enddate"));this.setDaysOfWeekDisabled(b.daysOfWeekDisabled||this.element.data("date-days-of-week-disabled")); this.fillDow();this.fillMonths();this.update();this.showMode()};m.prototype={constructor:m,_events:[],_attachEvents:function(){this._detachEvents();this._events=this.isInput?[[this.element,{focus:d.proxy(this.show,this),keyup:d.proxy(this.update,this),keydown:d.proxy(this.keydown,this)}]]:this.component&&this.hasInput?[[this.element.find("input"),{focus:d.proxy(this.show,this),keyup:d.proxy(this.update,this),keydown:d.proxy(this.keydown,this)}],[this.component,{click:d.proxy(this.show,this)}]]:[[this.element, {click:d.proxy(this.show,this)}]];for(var a=0,b,c;a<this._events.length;a++)b=this._events[a][0],c=this._events[a][1],b.on(c)},_detachEvents:function(){for(var a=0,b,c;a<this._events.length;a++)b=this._events[a][0],c=this._events[a][1],b.off(c);this._events=[]},show:function(a){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.update();this.place();d(window).on("resize",d.proxy(this.place,this));a&&(a.stopPropagation(),a.preventDefault());this.element.trigger({type:"show", date:this.date})},hide:function(){this.picker.hide();d(window).off("resize",this.place);this.viewMode=this.startViewMode;this.showMode();this.isInput||d(document).off("mousedown",this.hide);this.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue();this.element.trigger({type:"hide",date:this.date})},remove:function(){this._detachEvents();this.picker.remove();delete this.element.data().datepicker},getDate:function(){var a=this.getUTCDate(); return new Date(a.getTime()+6E4*a.getTimezoneOffset())},getUTCDate:function(){return this.date},setDate:function(a){this.setUTCDate(new Date(a.getTime()-6E4*a.getTimezoneOffset()))},setUTCDate:function(a){this.date=a;this.setValue()},setValue:function(){var a=k.formatDate(this.date,this.format,this.language);this.isInput?this.element.prop("value",a):(this.component&&this.element.find("input").prop("value",a),this.element.data("date",a))},setStartDate:function(a){this.startDate=a||-Infinity;-Infinity!== this.startDate&&(this.startDate=k.parseDate(this.startDate,this.format,this.language));this.update();this.updateNavArrows()},setEndDate:function(a){this.endDate=a||Infinity;Infinity!==this.endDate&&(this.endDate=k.parseDate(this.endDate,this.format,this.language));this.update();this.updateNavArrows()},setDaysOfWeekDisabled:function(a){this.daysOfWeekDisabled=a||[];d.isArray(this.daysOfWeekDisabled)||(this.daysOfWeekDisabled=this.daysOfWeekDisabled.split(/,\s*/));this.daysOfWeekDisabled=d.map(this.daysOfWeekDisabled, function(a){return parseInt(a,10)});this.update();this.updateNavArrows()},place:function(){var a=parseInt(this.element.parents().filter(function(){return"auto"!=d(this).css("z-index")}).first().css("z-index"))+10,b=this.component?this.component.offset():this.element.offset();this.picker.css({top:b.top+this.height,left:b.left,zIndex:a})},update:function(){this.date=k.parseDate(this.isInput?this.element.prop("value"):this.element.data("date")||this.element.find("input").prop("value"),this.format,this.language); this.viewDate=this.date<this.startDate?new Date(this.startDate):this.date>this.endDate?new Date(this.endDate):new Date(this.date);this.fill()},fillDow:function(){for(var a=this.weekStart,b="<tr>";a<this.weekStart+7;)b+='<th class="dow">'+n[this.language].daysMin[a++%7]+"</th>";this.picker.find(".datepicker-days thead").append(b+"</tr>")},fillMonths:function(){for(var a="",b=0;12>b;)a+='<span class="month">'+n[this.language].monthsShort[b++]+"</span>";this.picker.find(".datepicker-months td").html(a)}, fill:function(){var a=new Date(this.viewDate),b=a.getUTCFullYear(),c=a.getUTCMonth(),a=-Infinity!==this.startDate?this.startDate.getUTCFullYear():-Infinity,i=-Infinity!==this.startDate?this.startDate.getUTCMonth():-Infinity,g=Infinity!==this.endDate?this.endDate.getUTCFullYear():Infinity,f=Infinity!==this.endDate?this.endDate.getUTCMonth():Infinity,l=this.date.valueOf(),j=new Date;this.picker.find(".datepicker-days thead th:eq(1)").text(n[this.language].months[c]+" "+b);this.picker.find("tfoot th.today").text(n[this.language].today).toggle(!1!== this.todayBtn);this.updateNavArrows();this.fillMonths();var e=q(b,c-1,28,0,0,0,0),h=k.getDaysInMonth(e.getUTCFullYear(),e.getUTCMonth());e.setUTCDate(h);e.setUTCDate(h-(e.getUTCDay()-this.weekStart+7)%7);var m=new Date(e);m.setUTCDate(m.getUTCDate()+42);for(var m=m.valueOf(),h=[],p;e.valueOf()<m;){e.getUTCDay()==this.weekStart&&h.push("<tr>");p="";if(e.getUTCFullYear()<b||e.getUTCFullYear()==b&&e.getUTCMonth()<c)p+=" old";else if(e.getUTCFullYear()>b||e.getUTCFullYear()==b&&e.getUTCMonth()>c)p+=" new"; this.todayHighlight&&(e.getUTCFullYear()==j.getFullYear()&&e.getUTCMonth()==j.getMonth()&&e.getUTCDate()==j.getDate())&&(p+=" today");e.valueOf()==l&&(p+=" active");if(e.valueOf()<this.startDate||e.valueOf()>this.endDate||-1!==d.inArray(e.getUTCDay(),this.daysOfWeekDisabled))p+=" disabled";h.push('<td class="day'+p+'">'+e.getUTCDate()+"</td>");e.getUTCDay()==this.weekEnd&&h.push("</tr>");e.setUTCDate(e.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(h.join(""));c=this.date.getUTCFullYear(); h=this.picker.find(".datepicker-months").find("th:eq(1)").text(b).end().find("span").removeClass("active");c==b&&h.eq(this.date.getUTCMonth()).addClass("active");(b<a||b>g)&&h.addClass("disabled");b==a&&h.slice(0,i).addClass("disabled");b==g&&h.slice(f+1).addClass("disabled");h="";b=10*parseInt(b/10,10);i=this.picker.find(".datepicker-years").find("th:eq(1)").text(b+"-"+(b+9)).end().find("td");b-=1;for(f=-1;11>f;f++)h+='<span class="year'+(-1==f||10==f?" old":"")+(c==b?" active":"")+(b<a||b>g?" disabled": "")+'">'+b+"</span>",b+=1;i.html(h)},updateNavArrows:function(){var a=new Date(this.viewDate),b=a.getUTCFullYear(),a=a.getUTCMonth();switch(this.viewMode){case 0:-Infinity!==this.startDate&&b<=this.startDate.getUTCFullYear()&&a<=this.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"});Infinity!==this.endDate&&b>=this.endDate.getUTCFullYear()&&a>=this.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}): this.picker.find(".next").css({visibility:"visible"});break;case 1:case 2:-Infinity!==this.startDate&&b<=this.startDate.getUTCFullYear()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),Infinity!==this.endDate&&b>=this.endDate.getUTCFullYear()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}},click:function(a){a.stopPropagation();a.preventDefault();a=d(a.target).closest("span, td, th"); if(1==a.length)switch(a[0].nodeName.toLowerCase()){case "th":switch(a[0].className){case "switch":this.showMode(1);break;case "prev":case "next":a=k.modes[this.viewMode].navStep*("prev"==a[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,a);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,a)}this.fill();break;case "today":a=new Date,a.setUTCHours(0),a.setUTCMinutes(0),a.setUTCSeconds(0),a.setUTCMilliseconds(0),this.showMode(-2),this._setDate(a, "linked"==this.todayBtn?null:"view")}break;case "span":if(!a.is(".disabled")){this.viewDate.setUTCDate(1);if(a.is(".month")){var b=a.parent().find("span").index(a);this.viewDate.setUTCMonth(b);this.element.trigger({type:"changeMonth",date:this.viewDate})}else{var c=parseInt(a.text(),10)||0;this.viewDate.setUTCFullYear(c);this.element.trigger({type:"changeYear",date:this.viewDate})}this.showMode(-1);this.fill()}break;case "td":if(a.is(".day")&&!a.is(".disabled")){var i=parseInt(a.text(),10)||1,c=this.viewDate.getUTCFullYear(), b=this.viewDate.getUTCMonth();a.is(".old")?0==b?(b=11,c-=1):b-=1:a.is(".new")&&(11==b?(b=0,c+=1):b+=1);this._setDate(q(c,b,i,0,0,0,0))}}},_setDate:function(a,b){if(!b||"date"==b)this.date=a;if(!b||"view"==b)this.viewDate=a;this.fill();this.setValue();this.element.trigger({type:"changeDate",date:this.date});var c;this.isInput?c=this.element:this.component&&(c=this.element.find("input"));c&&(c.change(),this.autoclose&&(!b||"date"==b)&&this.hide())},moveMonth:function(a,b){if(!b)return a;var c=new Date(a.valueOf()), i=c.getUTCDate(),d=c.getUTCMonth(),f=Math.abs(b),l,b=0<b?1:-1;if(1==f){if(f=-1==b?function(){return c.getUTCMonth()==d}:function(){return c.getUTCMonth()!=l},l=d+b,c.setUTCMonth(l),0>l||11<l)l=(l+12)%12}else{for(var j=0;j<f;j++)c=this.moveMonth(c,b);l=c.getUTCMonth();c.setUTCDate(i);f=function(){return l!=c.getUTCMonth()}}for(;f();)c.setUTCDate(--i),c.setUTCMonth(l);return c},moveYear:function(a,b){return this.moveMonth(a,12*b)},dateWithinRange:function(a){return a>=this.startDate&&a<=this.endDate}, keydown:function(a){if(this.picker.is(":not(:visible)"))27==a.keyCode&&this.show();else{var b=!1,c,d,g;switch(a.keyCode){case 27:this.hide();a.preventDefault();break;case 37:case 39:if(!this.keyboardNavigation)break;c=37==a.keyCode?-1:1;a.ctrlKey?(d=this.moveYear(this.date,c),g=this.moveYear(this.viewDate,c)):a.shiftKey?(d=this.moveMonth(this.date,c),g=this.moveMonth(this.viewDate,c)):(d=new Date(this.date),d.setUTCDate(this.date.getUTCDate()+c),g=new Date(this.viewDate),g.setUTCDate(this.viewDate.getUTCDate()+ c));this.dateWithinRange(d)&&(this.date=d,this.viewDate=g,this.setValue(),this.update(),a.preventDefault(),b=!0);break;case 38:case 40:if(!this.keyboardNavigation)break;c=38==a.keyCode?-1:1;a.ctrlKey?(d=this.moveYear(this.date,c),g=this.moveYear(this.viewDate,c)):a.shiftKey?(d=this.moveMonth(this.date,c),g=this.moveMonth(this.viewDate,c)):(d=new Date(this.date),d.setUTCDate(this.date.getUTCDate()+7*c),g=new Date(this.viewDate),g.setUTCDate(this.viewDate.getUTCDate()+7*c));this.dateWithinRange(d)&& (this.date=d,this.viewDate=g,this.setValue(),this.update(),a.preventDefault(),b=!0);break;case 13:this.hide();a.preventDefault();break;case 9:this.hide()}if(b){this.element.trigger({type:"changeDate",date:this.date});var f;this.isInput?f=this.element:this.component&&(f=this.element.find("input"));f&&f.change()}}},showMode:function(a){a&&(this.viewMode=Math.max(0,Math.min(2,this.viewMode+a)));this.picker.find(">div").hide().filter(".datepicker-"+k.modes[this.viewMode].clsName).show();this.updateNavArrows()}}; d.fn.datepicker=function(a){var b=Array.apply(null,arguments);b.shift();return this.each(function(){var c=d(this),i=c.data("datepicker"),g="object"==typeof a&&a;i||c.data("datepicker",i=new m(this,d.extend({},d.fn.datepicker.defaults,g)));"string"==typeof a&&"function"==typeof i[a]&&i[a].apply(i,b)})};d.fn.datepicker.defaults={};d.fn.datepicker.Constructor=m;var n=d.fn.datepicker.dates={en:{days:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),daysShort:"Sun Mon Tue Wed Thu Fri Sat Sun".split(" "), daysMin:"Su Mo Tu We Th Fr Sa Su".split(" "),months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),today:"Today"}},k={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(a){return 0===a%4&&0!==a%100||0===a%400},getDaysInMonth:function(a,b){return[31,k.isLeapYear(a)? 29:28,31,30,31,30,31,31,30,31,30,31][b]},validParts:/dd?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[-`{-~\t\n\r]+/g,parseFormat:function(a){var b=a.replace(this.validParts,"\x00").split("\x00"),a=a.match(this.validParts);if(!b||!b.length||!a||0==a.length)throw Error("Invalid date format.");return{separators:b,parts:a}},parseDate:function(a,b,c){if(a instanceof Date)return a;if(/^[-+]\d+[dmwy]([\s,]+[-+]\d+[dmwy])*$/.test(a)){for(var i=/([-+]\d+)([dmwy])/,g=a.match(/([-+]\d+)([dmwy])/g),f,l,a= new Date,j=0;j<g.length;j++)switch(f=i.exec(g[j]),l=parseInt(f[1]),f[2]){case "d":a.setUTCDate(a.getUTCDate()+l);break;case "m":a=m.prototype.moveMonth.call(m.prototype,a,l);break;case "w":a.setUTCDate(a.getUTCDate()+7*l);break;case "y":a=m.prototype.moveYear.call(m.prototype,a,l)}return q(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),0,0,0)}g=a&&a.match(this.nonpunctuation)||[];a=new Date;i={};l="yyyy yy M MM m mm d dd".split(" ");var e={yyyy:function(a,b){return a.setUTCFullYear(b)},yy:function(a, b){return a.setUTCFullYear(2E3+b)},m:function(a,b){for(b-=1;0>b;)b+=12;b%=12;for(a.setUTCMonth(b);a.getUTCMonth()!=b;)a.setUTCDate(a.getUTCDate()-1);return a},d:function(a,b){return a.setUTCDate(b)}},h;e.M=e.MM=e.mm=e.m;e.dd=e.d;a=q(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0);if(g.length==b.parts.length){for(var j=0,k=b.parts.length;j<k;j++){h=parseInt(g[j],10);f=b.parts[j];if(isNaN(h))switch(f){case "MM":h=d(n[c].months).filter(function(){var a=this.slice(0,g[j].length),b=g[j].slice(0,a.length); return a==b});h=d.inArray(h[0],n[c].months)+1;break;case "M":h=d(n[c].monthsShort).filter(function(){var a=this.slice(0,g[j].length),b=g[j].slice(0,a.length);return a==b}),h=d.inArray(h[0],n[c].monthsShort)+1}i[f]=h}for(j=0;j<l.length;j++)if(f=l[j],f in i&&!isNaN(i[f]))e[f](a,i[f])}return a},formatDate:function(a,b,c){c={d:a.getUTCDate(),m:a.getUTCMonth()+1,M:n[c].monthsShort[a.getUTCMonth()],MM:n[c].months[a.getUTCMonth()],yy:a.getUTCFullYear().toString().substring(2),yyyy:a.getUTCFullYear()};c.dd= (10>c.d?"0":"")+c.d;c.mm=(10>c.m?"0":"")+c.m;for(var a=[],i=d.extend([],b.separators),g=0,f=b.parts.length;g<f;g++)i.length&&a.push(i.shift()),a.push(c[b.parts[g]]);return a.join("")},headTemplate:'<thead><tr><th class="prev"><i class="icon-arrow-left"/></th><th colspan="5" class="switch"></th><th class="next"><i class="icon-arrow-right"/></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr></tfoot>'};k.template= '<div class="datepicker dropdown-menu"><div class="datepicker-days"><table class=" table-condensed">'+k.headTemplate+"<tbody></tbody>"+k.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+k.headTemplate+k.contTemplate+k.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+k.headTemplate+k.contTemplate+k.footTemplate+"</table></div></div>"}(window.jQuery);